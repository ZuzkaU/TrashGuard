<html>
<head>
    <link rel="stylesheet" href="static/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="crossorigin=""/
    <link rel="stylesheet" href="https://leaflet.github.io/Leaflet.markercluster/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://leaflet.github.io/Leaflet.markercluster/dist/MarkerCluster.Default.css" />>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
<script src="https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js"></script>
<script src='https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster-src.js'></script>

<style>
  .logo
{
    display: inline-block;
    scale: 2.7;
    width: 156px;
    height: 30px;
        margin-top: 5px;
        background-size: auto 43px;
    background-image: url('static/header-t.png');
    background-repeat: no-repeat;
}
    .dropbtn {
  background-color: #ffffff;
  color: rgb(37, 29, 73);
  padding: 16px;
  border-radius: 4px;
  font-size: 16px;
  box-shadow: 0px 8px 16px 0px rgba(150, 150, 150, 0.774);
  border: none;
  cursor: pointer;
}

.dropdown {
  position: absolute;
  display: inline-block;
  z-index: 4000;
}

.dropdown-content {
  display: none;
  position: absolute;
  right: 0;
  background-color: #ffffff;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(175, 13, 13, 0.774);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.reportbtn {
  background-color: #ff2e2e;
  color: rgb(37, 29, 73);
  padding: 20px;
  font-size: 20px;
  box-shadow: 0px 8px 16px 8px rgba(175, 13, 13, 0.774);
  border-radius: 4px;
  border: none;
  cursor: pointer;
}

.dropdown-content a:hover {background-color: #eceaea;}
.dropdown:hover .dropdown-content {display: block;}
.dropdown:hover .dropbtn {background-color: #eceaea;}

#map{
  position: absolute;
  top: 0;
  left: -1;
  bottom: 0;
  width: 100%;
  height: 100%;
}


.openBtn {
  position: absolute;
display: flex;
justify-content: left;
  z-index: 1000;
}
.openButton {
border: none;
border-radius: 5px;
background-color: #db1835;
color: white;
padding: 14px 20px;
cursor: pointer;
position: fixed;

  z-index: 1;
}

      .loginPopup {
        text-align: center;
        width: 100%;
        height: 100%;
          z-index: 4000;
          justify-content: center;
      }
      .formPopup {
        display: none;
        width: auto;
        height: auto;
        border: none;
        z-index: 1000;
        margin: auto;
      position: absolute;
      z-index: 4000;
          justify-content: center;
          right: 50%;
      }
      .formContainer {
        width: 300px;
        padding: 20px;
        background-color: #fff;
        z-index: 1000;
        position: relative;
        height: auto;
          left: 50%;
          right: 50%;
      }
      .formContainer input[type=text] {
        width: 100%;
        padding: 15px;
        margin: 5px 0 20px 0;
        border: none;
        background: #eee;
      }
      .formContainer input[type=text]:focus {
        background-color: #ddd;
        outline: none;
      }
      .formContainer .btn {
        padding: 12px 20px;
        border: none;
        background-color: #8ebf42;
        color: #fff;
        cursor: pointer;
        width: 100%;
        margin-bottom: 15px;
        opacity: 0.8;
      }
      .formContainer .cancel {
        background-color: #cc0000;
      }
      .formContainer .btn:hover,
      .openButton:hover {
        opacity: 1;
      }
</style>
</head>


<body>
  <center>
    <div class="logo" onclick="window.location"></div>
  </center>
  <div class="dropdown" style="left:20;top:20;">
    <button class="dropbtn"><b>Menu</b></button>
    <div class="dropdown-content" style="left:0;">
      <a href='/login'>Profile</a>
      <a href="#">Information</a>
    </div>
  </div>

  <div class="openBtn" style="bottom:80;left:20">
      <button class="openButton" onclick="openForm()"><strong>Report Trash</strong></button>
  </div>
  
  <div class="loginPopup">
      <div class="formPopup" id="popupForm">
        <form class="formContainer" action="/report" method="post">
          <h2>Report Trash</h2>
          <label for="lat">
            <strong>Lattitude</strong>
          </label>
          <input type="text" id="lat-input" value="{{lat}}" name="lat" required>
          <label for="lon">
            <strong>Longtitude</strong>
          </label>
          <input type="text" id="lon-input" value="{{lon}}" name="lon" required>
          <button type="submit" class="btn">Report</button>
          <button type="button" class="btn cancel" onclick="closeForm()">Cancel</button>
        </form>
      </div>
    </div>
  <script>
      function openForm() {
        document.getElementById("popupForm").style.display = "block";
      }
      function closeForm() {
        document.getElementById("popupForm").style.display = "none";
      }
    </script>

    <div id="map"></div>

    </script>

    <script>
        var map = L.map('map', {zoomControl: false}).setView([{{lat}}, {{lon}}], 18);
        L.control.zoom({
             position:'bottomright'
        }).addTo(map);
        
        var WasteIcon = L.Icon.extend({
            options: {
                iconSize:     [27, 40],
                iconAnchor:   [13, 40],
                popupAnchor:  [1, -30]
            }
        });
        
        var waste_basket_icon = new WasteIcon({iconUrl: 'static/icons/waste_bin.png'}),
            recycling_icon = new WasteIcon({iconUrl: 'static/icons/recycling.png'}),
            waste_disposal_icon = new WasteIcon({iconUrl: 'static/icons/waste_disposal.png'});
        
        var my_position_icon = L.icon({iconUrl: 'static/icons/my_position.png',
                iconSize:     [30, 30],
                iconAnchor:   [15, 15]
            });
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'}).addTo(map);
        
        var baskets = L.markerClusterGroup({showCoverageOnHover: false});
        {{baskets|safe}}
        map.addLayer(baskets);
        
        var disposal = L.markerClusterGroup({showCoverageOnHover: false});
        {{disposal|safe}}
        map.addLayer(disposal);
        
        var recycling = L.markerClusterGroup({showCoverageOnHover: false});
        {{recycling|safe}}
        map.addLayer(recycling);
        
        var reported = L.markerClusterGroup({showCoverageOnHover: false});
        {{reported|safe}}
        map.addLayer(reported);
        
        L.marker([{{lat}}, {{lon}}], {icon: my_position_icon}).addTo(map);
        
        var overlayMaps = {
            "Waste Baskets": baskets,
            "Waste Disposal": disposal,
            "Recycling Bins": recycling,
            "Reported Trash": reported
        };
        L.control.layers({}, overlayMaps).addTo(map);
        
        
        command.addTo(map);
    </script>
</body>
</html>
